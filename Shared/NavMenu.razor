@using messager.Services.Interfaces;
@using messager.models;
@inject IUserService _UserService; 
@inject NavigationManager NavigationManager
<style>
  
    .button-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        margin-top:50px; 
        padding:5px;
        color: white;
    }

    .ButtonLayOut {
        background-color: rgb(51,187,255);
        padding: 10px;
        margin: 10px;
        align-self:center;
        display: table;
        border-radius: 15px;
        border:none;
        
        
    }
   
</style>
@if(_User != null)
{
    <div class="button-container">
    <p>twoi znajomi:</p>
    @foreach(var user in UserList)
    {
            <button class="ButtonLayOut" @onclick="@(() => RedirectToCshtml($"chat/{user.Id}"))">@user.UserName</button>
    }
    </div>
}
else
{
  
    <div class="button-container">
        <button class="ButtonLayOut" @onclick="@(() => RedirectToCshtml("account/login"))">Zaloguj się</button>
        <button class="ButtonLayOut" @onclick="@(() => RedirectToCshtml("account/register"))">Zarejestruj się</button>
    </div>
}


@code {
    private bool collapseNavMenu = true;
    private List<UserModel> UserList;
    private UserModel _User;
    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;
    protected override async Task OnInitializedAsync()
    {
        _User = await _UserService.GetLoggedUser();
        if (_User != null)
        {
            UserList = await _UserService.GetUsers(_User.Id);
        }
    }
    private void RedirectToCshtml(string url)
    {
        NavigationManager.NavigateTo(url, forceLoad: true);
    }

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }
    
}
